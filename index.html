<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OCR & Quiz App</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
</head>
<body class="theme-green">

<div class="container">

  <!-- ================== SIDEBAR ================== -->
  <div class="sidebar">
    <h2>OCR & Quiz App</h2>
    <button onclick="showPanel('ocrPanel')">Text Extractor</button>
    <button onclick="showPanel('quizPanel')">Quiz Generator</button>
    <button onclick="showPanel('settingsPanel')">Settings</button>
    <div class="setting-item">
      <label for="themeSelect">Theme</label>
      <select id="themeSelect">
        <option value="theme-green">Green</option>
        <option value="theme-dark">Dark</option>
        <option value="theme-darkgrey">Dark Grey</option>
        <option value="theme-black">Black</option>
        <option value="theme-white">White</option>
      </select>
    </div>
    <div class="setting-item">
      <label for="langSelect">Language</label>
      <select id="langSelect">
        <option value="ces">Czech</option>
        <option value="eng">English</option>
      </select>
    </div>
  </div>

  <!-- ================== MAIN CONTENT ================== -->
  <div class="main-content">

    <!-- ================== OCR PANEL ================== -->
    <div class="panel" id="ocrPanel">
      <h2>Text Extractor</h2>
      <input type="file" id="imageInput" accept="image/*">
      <button onclick="safeRunOCR()">Extract Text</button>

      <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
        <div id="progressText">Idle</div>
      </div>

      <textarea id="extractedText" placeholder="Extracted text will appear here..."></textarea>

      <button id="downloadTextBtn" onclick="downloadLastText()">Download Text</button>
      <button id="downloadImageBtn" onclick="downloadLastImage()">Download Image</button>

      <canvas id="preprocessCanvas" class="hidden"></canvas>

      <div id="extractorErrors" class="error hidden">
        <span id="extractorErrorMsg"></span>
      </div>
    </div>

    <!-- ================== QUIZ PANEL ================== -->
    <div class="panel hidden" id="quizPanel">
      <h2>Quiz Generator</h2>
      <div class="quiz-controls">
        <button onclick="safeCreateQuiz('ABCD')">Generate ABCD Quiz</button>
        <button onclick="safeCreateQuiz('TF')">Generate True/False Quiz</button>
        <button onclick="safeCreateQuiz('FIB')">Generate Fill-in-the-Blank</button>
        <button onclick="resetHistory()">Reset Past Quizzes</button>
        <button onclick="exportHistory()">Export Past Quizzes</button>
      </div>

      <div id="quizArea" class="quiz-area"></div>
      <div id="quizStatus" class="quiz-status"></div>

      <h3>Past Quizzes</h3>
      <div id="historyArea" class="history-area"></div>
    </div>

    <!-- ================== SETTINGS PANEL ================== -->
    <div class="panel hidden" id="settingsPanel">
      <h2>Settings</h2>
      <div class="setting-item">
        <label for="themeSelectSettings">Theme</label>
        <select id="themeSelectSettings" onchange="themeSelect.value=this.value; themeSelect.onchange()">
          <option value="theme-green">Green</option>
          <option value="theme-dark">Dark</option>
          <option value="theme-darkgrey">Dark Grey</option>
          <option value="theme-black">Black</option>
          <option value="theme-white">White</option>
        </select>
      </div>
      <div class="setting-item">
        <label for="langSelectSettings">Language</label>
        <select id="langSelectSettings" onchange="langSelect.value=this.value; langSelect.onchange()">
          <option value="ces">Czech</option>
          <option value="eng">English</option>
        </select>
      </div>

      <button id="exportStorageBtn" onclick="exportStorage()">Export Storage</button>
      <input type="file" id="importStorageBtn" onchange="importStorage(this.files)">
    </div>

  </div>
</div>

<!-- ================== NOTIFICATIONS & MODAL ================== -->
<div id="notificationContainer" class="notification hidden">
  <span id="notificationText"></span>
</div>

<div id="modalContainer" class="modal hidden">
  <div class="modal-content">
    <h3 id="modalTitle"></h3>
    <pre id="modalMessage"></pre>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<canvas id="debugContainer" class="hidden"></canvas>

<script src="storage.js"></script>
<script src="app.js"></script>
<script src="quiz.js"></script>

</body>
</html>
